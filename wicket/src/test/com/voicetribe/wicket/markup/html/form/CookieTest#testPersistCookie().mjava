    public void testPersistCookie() throws IOException, ServletException
    {
        panel.setPersistent(true);
        
        // test
        // will call persistFromComponentData(), which is private
		this.form.formSubmitted(cycle);
		
		// validate
        Collection cookies = application.getServletResponse().getCookies();
        Assert.assertEquals(2, cookies.size());
        Iterator iter = cookies.iterator();
        while (iter.hasNext()) 
        {
        	Cookie cookie = (Cookie)iter.next();
        	Assert.assertNotNull(page.get(cookie.getName()));
        	// Skip "deleted" cookies
        	if (page.get(cookie.getName()).getModelObjectAsString() != "")
        	{
        	    Assert.assertEquals(cookie.getValue(), page.get(cookie.getName()).getModelObjectAsString());
        	}
        }
    }

